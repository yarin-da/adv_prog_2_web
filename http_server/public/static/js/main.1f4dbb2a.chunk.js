(this.webpackJsonpweb_client=this.webpackJsonpweb_client||[]).push([[0],{202:function(e,t,n){},316:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(19),o=n.n(c),i=(n(202),n(7)),l=n(14),s=n(22),u=n.n(s),d=n(38),f="http://localhost:9876",b=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(f,"/api/models"));case 2:if(!(t=e.sent).ok){e.next=8;break}return e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",n);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(f,"/api/model?model_id=").concat(t));case 2:if(!(n=e.sent).ok){e.next=8;break}return e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(f,"/api/model?model_type=").concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({train_data:n})});case 2:if(!(r=e.sent).ok){e.next=8;break}return e.next=6,r.json();case 6:return a=e.sent,e.abrupt("return",a);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(f,"/api/model?model_id=").concat(t),{method:"DELETE"});case 2:return n=e.sent,e.abrupt("return",n.ok);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(f,"/api/anomaly?model_id=").concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({predict_data:n})});case 2:if(!(r=e.sent).ok){e.next=8;break}return e.next=6,r.json();case 6:return a=e.sent,e.abrupt("return",a);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),O=function(e){if(!(null==e||e.length<=0||null==e[0])){var t={},n=Object.keys(e[0]);n.forEach((function(e){t[e]=[]}));for(var r=function(r){n.forEach((function(n){t[n]=[].concat(Object(l.a)(t[n]),[e[r][n]])}))},a=0;a<e.length;a++)r(a);return t}},g={getModels:function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:null!=(n=e.sent)&&t(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getModel:function(){var e=Object(d.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t);case 2:null!=(r=e.sent)&&n(r);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),postModel:function(){var e=Object(d.a)(u.a.mark((function e(t,n,r){var a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O(n),e.next=3,p(t,a);case 3:null!=(c=e.sent)&&r(c);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),deleteModel:function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),postAnomalies:function(){var e=Object(d.a)(u.a.mark((function e(t,n,r){var a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O(n),e.next=3,m(t,a);case 3:null!=(c=e.sent)&&r(c);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},v=n(27),x=n(163),y=n(33),k=n(15),C=n(6),S=Object(y.a)((function(e){return{root:{borderColor:"#6c6c6c","& .MuiDataGrid-cell:focus-within":{outline:"none"},"& .anomalyRow":{backgroundColor:Object(k.a)(e.palette.error.main,.5),"&:hover":{backgroundColor:Object(k.a)(e.palette.error.main,.25)}},"& .MuiDataGrid-row":{"&:hover":{backgroundColor:Object(k.i)("#0a1a2a",.1)}}}}})),w=function(e){var t=e.data,n=e.anomalies,a=e.anomalyPair,c=Object(r.useMemo)((function(){return t.map((function(e,t){return Object(v.a)({id:t},e)}))}),[t]),o=Object(r.useMemo)((function(){return null==t||null==t[0]?[]:Object.keys(t[0]).map((function(e){return{field:e,headerName:e,sortable:!1,width:120}}))}),[t]),l=Object(r.useState)(new Set),s=Object(i.a)(l,2),u=s[0],d=s[1];Object(r.useEffect)((function(){if(null!=n){var e=Object.keys(n.anomalies).filter((function(e){return null==a||a.length<2||e===a[0]||e===a[1]})),t=new Set;e.forEach((function(e){n.anomalies[e].forEach((function(e){for(var n=e[0];n<e[1];n++)t.add(n)}))})),d(t)}}),[n,a]);var f=S();return Object(C.jsx)("div",{style:{padding:10},children:Object(C.jsx)(x.a,{rows:c,columns:o,className:f.root,disableSelectionOnClick:!0,disableColumnMenu:!0,getRowClassName:function(e){var t=e.row.id;return u.has(t)?"anomalyRow":"regularRow"},pageSize:100})})},M=n(100),D=n(322),P=n(364),_=n(325),A=n(365),E=n(168),R=n.n(E),T=n(167),N=n.n(T),I=n(166),F=n.n(I),U=n(62),z=n(128),J=n(165),L=n.n(J),W=n(363),G=function(e){var t=e.onSearchChanged,n=e.label;return Object(C.jsx)(z.a,{color:"secondary",variant:"filled",size:"small",style:{backgroundColor:"black"},onChange:function(e){return t(e.target.value)},label:n,fullWidth:!0,InputProps:{endAdornment:Object(C.jsx)(W.a,{position:"end",children:Object(C.jsx)(L.a,{})})}})};G.defaultProps={label:"Search",onSearchChanged:function(e){}};var H=G,B={backgroundColor:"#071727",color:"#fff"},q=function(e){var t=e.models,n=e.selectedModel,a=e.onModelSelected,c=e.onDeleteItem,o=Object(r.useState)(""),l=Object(i.a)(o,2),s=l[0],u=l[1],d=Object(r.useMemo)((function(){return s?t.filter((function(e){return"id=".concat(e.model_id," ").concat(e.upload_time," ").concat(e.status).includes(s)})):t}),[s,t]);return Object(C.jsxs)("div",{children:[Object(C.jsx)(H,{label:"Model List",onSearchChanged:function(e){u(e)}}),Object(C.jsx)(M.a,{style:B,height:285,itemSize:70,itemCount:d.length,children:function(e){var t,r=e.index,o=e.style,i=d[r],l=null!=n&&n.model_id===i.model_id,s=function(e){var t=e.split("T");return{date:t[0],hour:t[1].split("+")[0]}}(i.upload_time),u=s.date,f=s.hour;return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)(D.a,{button:!0,selected:l,onClick:function(e){return a(i)},style:o,children:[Object(C.jsx)(_.a,{children:"pending"===i.status?Object(C.jsx)(F.a,{}):Object(C.jsx)(N.a,{style:{color:"lightgreen"}})}),Object(C.jsx)(P.a,{primary:(t=i.model_id,"".concat(t%2===0?"Linear":"Hybrid"," ").concat(t)),secondary:"".concat(u," ").concat(f)}),Object(C.jsx)(U.a,{onClick:function(){return c(i.model_id)},children:Object(C.jsx)(R.a,{style:{color:"lightslategray"}})})]},r),Object(C.jsx)(A.a,{light:!0})]})}})]})},K=n(366),Q=n(169),V=n.n(Q),X=Object(y.a)({item:{"& span, & svg":{fontSize:"0.9rem"}}}),Y={backgroundColor:"#071727",color:"#fff"},Z=function(e){var t=e.anomalies,n=e.selectedAnomalyPair,a=e.onAnomalyPairSelected,c=X(),o=Object(r.useState)(""),l=Object(i.a)(o,2),s=l[0],u=l[1],d=Object(r.useMemo)((function(){return null==t?[]:Object.keys(t.reason).filter((function(e){var n="".concat(e," - ").concat(t.reason[e]);return!s||n.includes(s)}))}),[s,t]),f=function(e){return!(n.length<=0)&&e===n[0]};return Object(C.jsxs)("div",{children:[Object(C.jsx)(H,{label:"Anomaly List",onSearchChanged:function(e){u(e)}}),Object(C.jsx)(M.a,{style:Y,height:265,itemSize:50,itemCount:d.length,children:function(e){var n=e.index,r=d[n],o=t.reason[r];return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)(D.a,{button:!0,classes:c.listitem,selected:f(r),onClick:function(){return function(e,t){f(e)?a([]):a([e,t])}(r,o)},children:[Object(C.jsx)(K.a,{children:Object(C.jsx)(V.a,{style:{color:"lightcoral"}})}),Object(C.jsx)(P.a,{className:c.item,primary:r,secondary:o})]},n),Object(C.jsx)(A.a,{light:!0})]})}})]})},$=n(72),ee=n(174),te={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"25px",borderWidth:0,borderRadius:5,borderStyle:"solid",backgroundColor:"#acacac",color:"#555555",outline:"none",transition:"border .24s ease-in-out"},ne={backgroundColor:"lightgray",color:"black"},re={backgroundColor:"lightgreen",color:"black"},ae={backgroundColor:"lightcoral",color:"black"},ce=function(e){var t=e.text,n=e.type,a=e.onFileChosen,c=Object(ee.a)({accept:n,maxFiles:1,onDrop:a}),o=c.getRootProps,i=c.getInputProps,l=c.isDragActive,s=c.isDragAccept,u=c.isDragReject,d=Object(r.useMemo)((function(){return Object(v.a)(Object(v.a)(Object(v.a)(Object(v.a)({},te),l?ne:{}),s?re:{}),u?ae:{})}),[l,u,s]);return Object(C.jsx)("div",{className:"Unselectable",style:{margin:3},children:Object(C.jsxs)("div",Object(v.a)(Object(v.a)({},o({style:d})),{},{children:[Object(C.jsx)("input",Object(v.a)({},i())),Object(C.jsx)($.a,{style:{padding:10},children:t})]}))})},oe=function(e){var t=e.text,n=e.onDataChanged,a=Object(r.useCallback)((function(e){if(!(e.length<=0)){var t=e[0],r=new FileReader;r.onload=function(){var e=function(e){if(null==e)return[];var t=e.trim().split("\n");if(e.length<=0)return[];var n=t[0].trim().split(",");return t.slice(1,t.length-1).map((function(e){return function(e,t){var n={},r=e.trim().split(",");return t.forEach((function(e,t){n[e]=r[t]})),n}(e,n)}))}(r.result);n(e)},r.readAsText(t)}}),[n]);return Object(C.jsx)(ce,{text:t,type:".csv, application/vnd.ms-excel, text/csv",onFileChosen:a})},ie=n(9),le=n(10),se=n(18),ue=n(17),de=n(173),fe={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"aliceblue"}}},scales:{x:{ticks:{color:"aliceblue"},title:{display:!0,text:"timesteps",color:"aliceblue"}},y:{ticks:{color:"aliceblue"}}}},be=[{r:0,g:150,b:190},{r:110,g:85,b:150},{r:135,g:180,b:120},{r:185,g:185,b:100},{r:185,g:130,b:0}],je=function(e){Object(se.a)(n,e);var t=Object(ue.a)(n);function n(){return Object(ie.a)(this,n),t.apply(this,arguments)}return Object(le.a)(n,[{key:"getColor",value:function(e){var t=be[e%be.length];return"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", 1)")}},{key:"missingData",value:function(e,t){return null==e||null==e[0]||null==t}},{key:"isAnomaly",value:function(e,t,n,r){var a=e.anomalies[t];if(null==a)return!1;for(var c=0;c<a.length;c++){var o=a[c][0]/n,i=a[c][1]/n,l=r.p0.parsed.x;if(o<=l&&l<=i)return!0}return!1}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.graphUpdates!==e.graphUpdates}},{key:"createChartData",value:function(e,t,n){var r=this;if(this.missingData(e,n))return{};for(var a=Math.min(150,e.length),c=Math.trunc(e.length/a),o=[],i=0,l=0;l<a;l++)o.push(i),i+=c;var s=Object.keys(e[0]);return{labels:o,datasets:s.filter((function(e,n){return t.length>0?t.includes(e):0<n&&n<=Math.min(s.length-1,5)})).map((function(a,o){var i=r.getColor(o),l=e.filter((function(e,t){return t%c===0})).map((function(e){return e[a]}));return{label:a,data:l,borderColor:i,radius:0,pointHitRadius:15,segment:{borderColor:function(e){var a=r.isAnomaly(n,t[0],c,e);return null!=t&&a?"rgb(200, 70, 70)":void 0}}}}))}}},{key:"render",value:function(){var e=this.props.data,t=this.props.anomalyPair,n=this.props.anomalies,r=this.createChartData(e,t,n);return Object(C.jsx)("div",{className:"GraphPanel",children:Object(C.jsx)(de.a,{options:fe,data:r})})}}]),n}(a.a.Component),pe=n(63),he=n(67),me=n(360),Oe=Object(he.a)({palette:{type:"dark",secondary:{light:"#4fb3bf",main:"#00838f",dark:"#005662",textPrimary:"#ffffff"},primary:{light:"#324053",main:"#0a1a2a",dark:"#000000",textPrimary:"#ffffff"},text:{main:"#ffffff",primary:"#ffffff",secondary:"#9a9a9a",disabled:"#6c6c6c"}}}),ge=function(e){var t=e.models,n=e.selectedModel,r=e.setSelectedModel,a=e.anomalies,c=e.detectData,o=e.setDetectData,i=e.setTrainData,l=e.modelType,s=e.setModelType,u=e.graphUpdates,d=e.selectedAnomalyPair,f=e.setSelectedAnomalyPair,b=e.deleteModel;return Object(C.jsx)(me.a,{theme:Oe,children:Object(C.jsxs)("div",{className:"MainPage",children:[Object(C.jsxs)("div",{children:[Object(C.jsxs)("div",{style:{margin:10,border:"solid 2px #324053",borderRadius:4},children:[Object(C.jsx)(Z,{anomalies:a,selectedAnomalyPair:d,onAnomalyPairSelected:f}),Object(C.jsx)(oe,{onDataChanged:o,text:"Drop a flight data file"})]}),Object(C.jsxs)("div",{style:{margin:10,border:"solid 2px #324053",borderRadius:4},children:[Object(C.jsx)(q,{models:t,selectedModel:n,onModelSelected:r,onDeleteItem:b}),Object(C.jsx)(oe,{onDataChanged:i,text:"Drop a training data file"}),Object(C.jsxs)("div",{style:{margin:2},children:[Object(C.jsx)(pe.a,{fullWidth:!0,color:"secondary",variant:"regression"===l?"contained":"outlined",onClick:function(){return s("regression")},children:"Regression"}),Object(C.jsx)(pe.a,{fullWidth:!0,color:"secondary",variant:"hybrid"===l?"contained":"outlined",onClick:function(){return s("hybrid")},children:"Hybrid"})]})]})]}),Object(C.jsx)("div",{className:"DataPanel",children:Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(je,{data:c,anomalyPair:d,anomalies:a,graphUpdates:u}),Object(C.jsx)(w,{data:c,anomalyPair:d,anomalies:a})]})})]})})},ve=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),o=Object(i.a)(c,2),l=o[0],s=o[1],u=Object(r.useState)(null),d=Object(i.a)(u,2),f=d[0],b=d[1],j=Object(r.useState)([]),p=Object(i.a)(j,2),h=p[0],m=p[1],O=Object(r.useState)([]),v=Object(i.a)(O,2),x=v[0],y=v[1],k=Object(r.useState)("regression"),S=Object(i.a)(k,2),w=S[0],M=S[1],D=Object(r.useState)(0),P=Object(i.a)(D,2),_=P[0],A=P[1],E=Object(r.useState)([]),R=Object(i.a)(E,2),T=R[0],N=R[1],I=Object(r.useRef)();I.current=n;var F=Object(r.useCallback)((function(){g.getModels((function(e){var t,n;t=e,n=I.current,t.length===n.length&&t.every((function(e,t){return Object.keys(e).every((function(r){return e[r]===n[t][r]}))}))||a((function(t){return e}))}))}),[]);return Object(r.useEffect)((function(){var e=setInterval((function(){return F()}),1e3);return F(),function(){return clearInterval(e)}}),[F]),Object(r.useEffect)((function(){null==x||x.length<=0||g.postModel(w,x,(function(e){y([])}))}),[x,w]),Object(r.useEffect)((function(){null!=l&&(null==n.find((function(e){return e.model_id===l.model_id}))&&s(null))}),[n,l]),Object(r.useEffect)((function(){h.length<=0||null==l||"ready"!==l.status||g.postAnomalies(l.model_id,h,(function(e){b(e)}))}),[h,l]),Object(r.useEffect)((function(){A((function(e){return e+1}))}),[f,T]),Object(C.jsx)(ge,{models:n,selectedModel:l,setSelectedModel:s,anomalies:f,detectData:h,setDetectData:m,setTrainData:y,modelType:w,setModelType:M,graphUpdates:_,selectedAnomalyPair:T,setSelectedAnomalyPair:N,deleteModel:function(e){g.deleteModel(e),a(n.filter((function(t){return t.model_id!==e})))}})};o.a.render(Object(C.jsx)(a.a.StrictMode,{children:Object(C.jsx)(ve,{})}),document.getElementById("root"))}},[[316,1,2]]]);
//# sourceMappingURL=main.1f4dbb2a.chunk.js.map